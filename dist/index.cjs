"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("@hookform/resolvers/zod"),t=require("react-hook-form"),s=require("lodash/merge"),r=require("zod"),n=require("react"),a=require("react/jsx-runtime"),l=require("react-select");const o={string:(e=r.string(),t="")=>({type:"spec",schema:r.preprocess(e=>e?String(e):void 0,r.union([r.string(),r.undefined()])).pipe(e),defaultValue:t}),number:(e=r.number(),t="")=>({type:"spec",schema:r.preprocess(e=>e?Number(e):void 0,r.union([r.number(),r.undefined()])).pipe(e),defaultValue:t}),custom:(e,t=void 0)=>({type:"spec",schema:e,defaultValue:t})};function i(e){const t=t=>{if(!t?.name)return null;const{name:s,label:r,id:l,...o}=t,i=l||n.useId();return a.jsx(d,{name:s,label:r,id:i,children:a.jsx(e,{name:s,...o,id:i})})};return t.displayName="withFormControl",n.memo(t)}const d=({name:e,id:t,label:s,children:r})=>{const n=m(e);return a.jsxs("div",{className:"form-control",children:[a.jsx(c,{label:s||null,id:t}),r,a.jsx(u,{message:n?.message||null,messageType:n?.type||null})]})},c=n.memo(({label:e,id:t})=>e?a.jsx("label",{htmlFor:t,children:e}):null);c.displayName="FieldLabel";const u=({message:e,messageType:t})=>e?a.jsx("div",{className:"invalid-feedback","data-feedback-type":t,children:e}):null,m=e=>{const{errors:s}=t.useFormState({name:e});return t.get(s,e)||null},p=(e,s=!1)=>{const{register:r,control:n}=t.useFormContext();if(s){const{field:s}=t.useController({name:e,control:n});return s}return r(e)},f=(e,t="POST")=>async s=>{const r=new FormData;for(const e in s)r.append(e,s[e]);await fetch(e,{method:t,body:JSON.stringify(s)}).then(async e=>{})},x=({name:e,type:t="text",...s})=>a.jsx("input",{type:t,...s,...p(e)});x.displayName="FieldInput";const h=i(x),b=({name:e,...t})=>a.jsx("textarea",{...t,...p(e)});b.displayName="FieldTextarea";const y=i(b),j=({children:e,...t})=>a.jsx("select",{...t,children:e});j.displayName="FieldNativeSelect";const F=i(j),g=({name:e,...t})=>{const s=p(e,!0);return a.jsx(l,{...t,...s,classNamePrefix:"react-select",inputId:t?.id,id:void 0})};g.displayName="FieldNativeSelect";const S=i(g),v=n.memo(({label:e,autoHide:s=!1,...r})=>{const{isDirty:n,isSubmitting:l,isLoading:o}=t.useFormState();return s&&!n?null:a.jsx("button",{type:"submit",...r,children:e||null})});exports.FieldHidden=({name:e,...t})=>a.jsx("input",{type:"hidden",...t,...p(e)}),exports.FieldInput=h,exports.FieldNativeSelect=F,exports.FieldReactSelect=S,exports.FieldTextarea=y,exports.Form=({form:e,children:s,disabled:r=!1,...n})=>a.jsx(t.FormProvider,{...e,children:a.jsx("form",{noValidate:!0,...n,onSubmit:e.handleSubmit(n?.onSubmit||f(n?.action||"",n?.method)),children:a.jsx("fieldset",{className:"form-scope",disabled:r,children:s})})}),exports.Submit=v,exports.createForm=(r,a)=>({form:t.useForm({...a,defaultValues:s({},r.defaultValues,a?.defaultValues),resolver:e.zodResolver(r.schema)}),attach:(e,t)=>({name:e,...n.useMemo(()=>t,[])})}),exports.createSchema=function(e,t){const s=e=>{const t={},n={};for(const a in e){const l=e[a];if("type"in l&&"spec"===l.type)t[a]=l.schema,n[a]=l.defaultValue;else{const e=s(l);t[a]=r.object(e.shape),n[a]=e.defaults}}return{shape:t,defaults:n}},{shape:n,defaults:a}=s(e);return{schema:t?t(r.object(n)):r.object(n),defaultValues:a}},exports.fieldBind=p,exports.spec=o,exports.withFormControl=i;
